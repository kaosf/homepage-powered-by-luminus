<!DOCTYPE html>
<html lang="ja">
<head>
<meta http-equiv="content-type" content="text/html" charset="utf-8">
<link rel="stylesheet" href="diary.css" type="text/css">
<title>2009-03</title>
</head>
<body>
<h1 class="diary_month">2009-03</h1>
<hr>
<a href="./" class="diary">戻る</a>
<hr>
<a name="03"></a>
<div class="diary">
<h2 class="diary_date_header">2009-03-03T00:40:38 (Tue)</h2>
<h2 class="diary_title">引越の荷物出し完了</h2>
<div class="diary_body">
家具・家電の類は新しく買い，それを新居に配送手続き済みなので，荷物はとても少ないです．そんなときオススメなのが日通の単身パック．S と L の二種類のサイズがあるのでそこは個人のお好みでチョイス．<br>
<br>
何と言っても魅力はその安さ．私は S サイズを徳島から神奈川までで，なんと 27,300 円でした．インターネットによる予約割引適用済みの料金です．<br>
<br>
ちなみに運んだのは PC 2 台 (ATX ケース)，液晶モニタ 2 台，プリンタ 1 台，その他周辺機器と掃除機と本と CD と台所用品と衣類を詰めた段ボール箱 12, 3 箱程度です．最初は「これは乗らないかも…」と思ってましたが，プロの技によりカートに全て収まりましたｗ<br>
<br>
5 日の午前にその荷物やら家具・家電が到着する予定なので，4 日の夜に夜行高速バスで東京へ向かって出発です．それまでデスクトップ PC が使えないので EeePC オンリーのわびしい生活… (´・ω・`)<br>
</div>
</div>
<a name="04"></a>
<div class="diary">
<h2 class="diary_date_header">2009-03-04T04:17:14 (Wed)</h2>
<h2 class="diary_title">いよいよ今晩出発なわけですが</h2>
<div class="diary_body">
毎度おなじみの夜行バスで行くので，グッスリ寝られるようにと思ってなるべく睡眠時間を減らしています．正直今ちょっとキツい… (寝落ちしそう…<br>
<br>
<a href="http://umineco.info/" target="_blank">うみねこのなく頃にWiki</a><br>
<br>
こんなの読んで暇つぶししてますｗ (^^;<br>
<br>
Ep4 まで踏まえて色々と考えると楽しいですね．正直今の時点が一番楽しい時期だと思います．<br>
<br>
引越して暇が出来たら，また Ep1 から読み直そうかなぁ…とか考えてたり．<br>
</div>
</div>
<a name="06"></a>
<div class="diary">
<h2 class="diary_date_header">2009-03-06T17:28:29 (Fri)</h2>
<h2 class="diary_title">引越は昨日終わりました</h2>
<div class="diary_body">
先日新居に入居しました．引越の荷物受け取り (家電・ふとん・その他の荷物) を全て完了し，電気や水道の使用開始手続きも終了しました．ひとまず生きていくための問題点は特にありません．<br>
<br>
しかし困ったことが 3 点発生．<br>
<br>
1 つ目は，インターネットの開通が最低でも 3 週間後になるということ．昨日すぐに連絡したのですが，3 月のこの時期でもお客は沢山いるようでそのくらいの期間掛かると言われました．EMOBILE があるのでインターネットが出来ないわけではないのですが，「同時に 1 台まで」や「速さが出ない」という問題点はどうしようもありません orz　3 週間の辛抱です．<br>
<br>
2 つ目は，メイン PC のマザーボードが恐らく壊れてしまったこと．BIOS すら起動しないので，きっとマザボでしょう．これにより Windows XP が起動しません．ゲームの開発はおろか，東方地霊殿や東方幻想麻雀すら遊べません．とは言え，マイクロ ATX で小さい上に SATA ポートが 2 つしか無いため大容量の HDD を持て余していたので，いつか買い換えようとは思っていました．いい機会です．これは明日アキバに買いに行こうと思います．定額給付金がこれで消えたｗ<br>
<br>
3 つ目は，昨日入居後間もなく撮影した部屋の様子が PC に取り込めないと判明したこと．古いデジカメだったので，記憶媒体が SD カードじゃなかった (xD Picture Card とかいうやつだった) ためです．SD カードだと信じてやまなかった自分は，変換アダプタしか持って来てませんでしたｗ　PC と直接繋げられる USB ケーブルも持って来ておけばよかったんだ… orz　これも明日アキバで調達しようと思います．<br>
<br>
2 つ目と 3 つ目は例大祭終わって落ち着くまでには解決しようと思いますし，出来ると思います．頑張ろうー．<br>
</div>
</div>
<a name="08"></a>
<div class="diary">
<h2 class="diary_date_header">2009-03-08T00:41:43 (Sun)</h2>
<h2 class="diary_title">本日の購入物</h2>
<div class="diary_body">
秋葉原で飲み会のついでにお買い物してきました．後々のために完全なるメモを残しておきます．<br>
<br>
<a href="http://www.asus.co.jp/products.aspx?l1=3&l2=11&l3=709&l4=0&model=2267&modelmenu=1" target="_blank">マザーボード (ASUS P5Q-E)</a><br>
クレバリー 1 号店 \14,983<br>
<br>
<a href="http://www.ainex.jp/products/as-04.htm" target="_blank">セラミックグリス (Ainex AS-04)</a><br>
クレバリー 1 号店 \733<br>
<br>
<a href="http://www.nintendo.co.jp/ds/unsj/" target="_blank">DS テレビ</a><br>
ヨドバシカメラ \6,800<br>
<br>
<a href="http://www.sanwa.co.jp/product/syohin.asp?code=ACA-IP6" target="_blank">iPod shuffle のコンセントでの充電用機器 (サンワサプライ ACA-IP6)</a><br>
ヨドバシカメラ \1,250<br>
</div>
</div>
<a name="08"></a>
<div class="diary">
<h2 class="diary_date_header">2009-03-08T22:34:17 (Sun)</h2>
<h2 class="diary_title">例大祭</h2>
<div class="diary_body">
本日は例大祭でしたね．参加された皆様，スタッフの皆様，お疲れ様でした．<br>
<br>
ちなみに私は本日，8:30 に起きて開場時間に間に合うくらいに到着出来ればいいや～…とか考えていたのですが目が覚めてみると目覚ましが止まっていて時既に 10:30 という間抜けっぷりｗｗｗｗ<br>
<br>
一応会場には行きましたが，戦利品はカタログのみという悲惨さ (^ω^)　東方幻想麻雀は明日から委託開始とのことで，必ずショップで手に入れることにします．<br>
</div>
</div>
<a name="09"></a>
<div class="diary">
<h2 class="diary_date_header">2009-03-09T23:50:02 (Mon)</h2>
<h2 class="diary_title">本日の購入物</h2>
<div class="diary_body">
<a href="http://www.adata-group.com/JP/product_show.php?ProductNo=AD2800U" target="_blank">メモリ (A-DATA DDR2 800)</a><br>
ドスパラ \4,280<br>
<br>
これで夢の RAM 4GB です．まぁ 32bit OS なので 3 GB ちょいしか認識しませんが，余った分は OS がスワップ領域に使ってくれるとか何とか聞いたので，別に良し．<br>
<br>
後で PC の構成をメモしておこう．<br>
</div>
</div>
<a name="10"></a>
<div class="diary">
<h2 class="diary_date_header">2009-03-10T03:16:49 (Tue)</h2>
<h2 class="diary_title">Twitter は「楽しいもの」じゃなくて「楽しむもの」</h2>
<div class="diary_body">
<a href="http://d.hatena.ne.jp/coconutsfine/20080512/1210598004" target="_blank">twitterが楽しめる人と楽しめない人の違いについて</a> (<a href="http://d.hatena.ne.jp/coconutsfine/" target="_blank">Cheshire　Life</a>)<br>
<br>
<a href="http://kaosf.kirara.st/sb/log/eid53.html" target="_blank">自分もかつて似たようなこと書いてました</a>が，やっぱり皆同じような考えに至るのですね．<br>
<br>
Twitter は自分から楽しんでやろうと思わなければまず楽しめないでしょう．というより世の中の大抵の娯楽ってのはそういうものですよね．<br>
<br>
一度も話したことのない相手に Reply を飛ばすのは最初は気が引けるかもしれませんが，それは現実でも同じようなものですよ．勇気を出して一言声を掛けて見ることから全ては始まるのですよね，ほんと．<br>
</div>
</div>
<a name="11"></a>
<div class="diary">
<h2 class="diary_date_header">2009-03-11T00:41:11 (Wed)</h2>
<h2 class="diary_title">Ruby 1.9.1 をインストール</h2>
<div class="diary_body">
Windows XP を新しく入れ直したので Ruby も入れ直さなければなりません．てことでインストールのメモ．<br>
<br>
<a href="http://www.geocities.co.jp/SiliconValley-PaloAlto/9251/ruby/" target="_blank">ActiveScriptRuby</a> には 1.8.5 が最新版として置かれてあったので，せっかくなので 1.9 をインストールしようと思って <a href="http://www.garbagecollect.jp/ruby/mswin32/ja/" target="_blank">Ruby-mswin32</a> から ruby-1.9.1-p0-i386-mswin32.zip をダウンロード．<br>
<br>
展開して C:\bin\ruby\ に設置．ユーザの環境変数 PATH (※デフォルトでは無いので注意) に C:\bin\ruby\bin を追加してインストール完了．コマンドプロンプトで ruby -v と打って 1.9.1p0 何とかかんとか～ …と表示されれば OK．<br>
<br>
ディレクトリ名などはインストールする人の好みで変更してくれて OK．個人的に Program Files が嫌い (スペースが入るので…) なので，こうしてあります．<br>
<br>
単純に多数のファイルに対する文字列処理なんぞに使うだけが目的なので，<a href="http://www.garbagecollect.jp/ruby/mswin32/ja/documents/install.html" target="_blank">ココ</a>で紹介されているものはダウンロードしない．後で必要になったときに入れる．<br>
<br>
ちなみに超便利な irb は readline が必要とのエラーが出ますが，何故か使えることは使えます．<br>
<br>
あと RubyGems を用いて Twitter ライブラリを使うために必要なものとそのインストール方法は手前味噌ですがコチラ (<a href="http://kaosf.kirara.st/sb/log/eid87.html" target="_blank">Twitter bot with Ruby 作成奮闘記 2</a>, <a href="http://kaosf.kirara.st/sb/log/eid88.html" target="_blank">Twitter bot with Ruby 作成奮闘記 3</a>) を．<br>
</div>
</div>
<a name="13"></a>
<div class="diary">
<h2 class="diary_date_header">2009-03-13T00:39:58 (Fri)</h2>
<h2 class="diary_title">家計簿ソフト</h2>
<div class="diary_body">
OpenOffice の Calc で家計簿を付けようと思って色々考えていたら，フリーで家計簿のソフトあるんだからそれを使えば良いではないかと Twitter でシューター部の部長さんから言われました．なので早速ググって出てきた，なおかつ AP さんも使用している<a href="http://www.eases.jp/product/ukiuki/ukiuki.htm" target="_blank">うきうき家計簿</a>というソフトをインストール．<br>
<br>
最初，細かすぎる出費の項目に「あうあう (^ω^;)」となりましたが，実は項目を自分で追加したり削除したり出来ることに気付いて今では「家計簿おいしいです ^q^」状態に．<br>
<br>
これから 2 年間の大学院生活では節約しようとはあまり思いませんが (学生の身分でお金なんぞ貯めてもしょうがない & 大した額にはならないという考え)，使い過ぎないよう気を付けたいものです．<br>
</div>
<h3 class="diary_comment_header">comments</h3>
<div class="diary_comment">
<h3 class="diary_comment_author">紀行 (2009-03-13T13:53:11)</h3>
<div class="diary_comment_body">
家計簿はCalc→うきうき→Calcな俺が通りますよ<br>
<br>
うきうきは結局入力が面倒で続かなかった<br>
</div>
<h3 class="diary_comment_author">か (2009-03-15T03:57:12)</h3>
<div class="diary_comment_body">
確かに入力は面倒だ～ｗｗ　特に金額がｗ<br>
<br>
でも表をいちいち作らなくてもいいので，こっちをしばらく使ってみます (^^;<br>
</div>
</div>
</div>
<a name="15"></a>
<div class="diary">
<h2 class="diary_date_header">2009-03-15T03:43:13 (Sun)</h2>
<h2 class="diary_title">Squirrel 動作実験 0</h2>
<div class="diary_body">
13 日から <a href="http://squirrel-lang.org/" target="_blank">Squirrel</a> の動作に関して本格的に実験を開始しています．<br>
<br>
環境は Visual Studio 2008 の Visual C++ 9.0 と Squirrel 2.2.2 stable です．<br>
<br>
本日ようやく Hello World プログラムの動作まで漕ぎ着けました．<br>
<br>
そこまでのプロセスを公開したいところですが，何分理解出来ていないところ (サンプルそのまま + 動かないところを訳も分からず改造した箇所) が多いので，まとまってから情報を出して行こうと思います．変に間違っていたら後から修正するのも面倒ですし (ぉ<br>
</div>
</div>
<a name="15"></a>
<div class="diary">
<h2 class="diary_date_header">2009-03-15T03:51:04 (Sun)</h2>
<h2 class="diary_title">ANSI 規約 (命名規約)</h2>
<div class="diary_body">
今日 Twitter で初めて知ったのでメモ．何故今まで知らなかったんだという自戒の意味も込めて．<br>
<br>
・_ (アンダースコア 1 つ) で始まり英大文字に続く名前<br>
・__ (アンダースコア 2 つ) で始まる名前<br>
<br>
以上 2 点は，処理系 (コンパイラ + 標準ライブラリ) 作者のために予約されている (ANSI 規約)．よって可能ならば使用しない方が望ましい．<br>
<br>
使用は出来るが，使用して名前が衝突しても文句言うなよ？ということだそうで．<br>
</div>
</div>
<a name="19"></a>
<div class="diary">
<h2 class="diary_date_header">2009-03-19T06:55:05 (Thu)</h2>
<h2 class="diary_title">Squirrel 動作実験 1</h2>
<div class="diary_body">
いきなりドン詰まりました orz<br>
<br>
sq_compile した後，sq_get でフェッチしようとしても成功しません．<br>
<br>
ソースは以下のような感じ．<br>
<br>
<blockquote>//main.cpp<br>
#include &lt;cstdio&gt;<br>
#include &lt;iostream&gt;<br>
using namespace std;<br>
<br>
#include &lt;squirrel.h&gt;<br>
<br>
SQInteger getCharForSquirrel(SQUserPointer fp)<br>
{<br>
　int c = getc(static_cast&lt;FILE*&gt;(fp));<br>
　if (c == EOF) {<br>
　　c = 0;<br>
　}<br>
　return static_cast&lt;SQInteger&gt;(c);<br>
}<br>
<br>
int main()<br>
{<br>
　//初期化<br>
　HSQUIRRELVM v = ::sq_open(1024);<br>
<br>
　//コンパイル<br>
　char* filename = _SC("test.nut");<br>
　FILE* fp;<br>
　fopen_s(&fp, filename, "r");<br>
　//FILE* fp = fopen(filename, "r"); //こう書いても良い (警告が出るだけ<br>
　if (fp == NULL) {<br>
　　cout &lt;&lt; "error 1" &lt;&lt; endl;<br>
　　getchar();<br>
　　return 1;<br>
　}<br>
　if (SQ_FAILED(::sq_compile(v, getCharForSquirrel, fp, filename, SQFalse))) {<br>
　　fclose(fp);<br>
　　cout &lt;&lt; "error 2" &lt;&lt; endl;<br>
　　getchar();<br>
　　return 2;<br>
　}<br>
　fclose(fp);<br>
<br>
　//C++ から Squirrel の関数を呼ぶ<br>
　int x = 10, y = 20, z = 0;<br>
　int top = ::sq_gettop(v);<br>
　::sq_pushroottable(v);<br>
　::sq_pushstring(v, _SC("foo"), -1);<br>
　if (SQ_FAILED(::sq_get(v, -2))) {<br>
　　cout &lt;&lt; "error 3" &lt;&lt; endl;<br>
　　getchar();<br>
　　return 3;<br>
　}<br>
　::sq_pushroottable(v);<br>
　::sq_pushinteger(v, x);<br>
　::sq_pushinteger(v, y);<br>
　if (SQ_FAILED(::sq_call(v, 3, SQTrue, SQFalse))) {<br>
　　cout &lt;&lt; "error 4" &lt;&lt; endl;<br>
　　getchar();<br>
　　return 4;<br>
　}<br>
　::sq_getinteger(v, -1, &z);<br>
　::sq_settop(v, top);<br>
　cout &lt;&lt; "x = " &lt;&lt; x &lt;&lt; endl;<br>
　cout &lt;&lt; "y = " &lt;&lt; y &lt;&lt; endl;<br>
　cout &lt;&lt; "x + y = " &lt;&lt; z &lt;&lt; endl;<br>
　getchar();<br>
<br>
　//終了処理<br>
　::sq_pop(v, 1);<br>
　::sq_close(v);<br>
　return 0;<br>
}<br>
</blockquote><br>
<blockquote>//test.nut<br>
function foo(x, y) {<br>
　return (x + y);<br>
}<br>
</blockquote><br>
error 3 で必ず止まってしまわれます．<br>
<br>
何が悪いんだろうね？ (・ω・)　これが解決しないことには先に進めない気がします．<br>
<br>
[追記]<br>
<br>
解決しました．次の次のエントリに原因と解決策があります．<br>
</div>
</div>
<a name="19"></a>
<div class="diary">
<h2 class="diary_date_header">2009-03-19T11:01:02 (Thu)</h2>
<h2 class="diary_title">やる夫で学ぶシリーズ</h2>
<div class="diary_body">
<a href="http://workingnews.blog117.fc2.com/blog-entry-1818.html" target="_blank">やる夫がマスコミに疑問を持ったようです 【前編】</a> / <a href="http://workingnews.blog117.fc2.com/blog-entry-1822.html" target="_blank">【中編】</a> / <a href="http://workingnews.blog117.fc2.com/blog-entry-1828.html" target="_blank">【後編】</a><br>
<br>
一口にマスゴミだ何だと言って片付けられる問題でもないんだよ，ということの本質を教えてくれます．<br>
<br>
<a href="http://workingnews.blog117.fc2.com/blog-entry-1762.html" target="_blank">やる夫が儲けるようです　第一部　古代編「お金の誕生」</a> / <a href="http://workingnews.blog117.fc2.com/blog-entry-1772.html" target="_blank">第ニ部　近代編「金銭の概念化」 </a> / <a href="http://workingnews.blog117.fc2.com/blog-entry-1780.html" target="_blank">第三部　最終話</a><br>
<br>
お金，貨幣がどのようにして誕生したのか，それが歴史を経てどのように様変わりしているのか，またそれに伴ってどのような利点・欠点が生まれたのか，などの話が分かりやすく説明されています．<br>
<br>
(以上 2 件 : <a href="http://workingnews.blog117.fc2.com/" target="_blank">働くモノニュース : 人生VIP職人ブログwww</a>)<br>
<br>
ちなみに当ブログで過去に経済関連ネタのやる夫シリーズを紹介したエントリは以下 2 件<br>
<a href="http://kaosf.kirara.st/sb/log/eid14.html" target="_blank">2008-06-19 : やる夫で学ぶシリーズ（経済関係）</a><br>
<a href="http://kaosf.kirara.st/sb/log/eid115.html" target="_blank">2008-10-29 : やる夫で学ぶ世界恐慌・1929</a><br>
<br>
<a href="http://yaruomatome.blog10.fc2.com/blog-entry-964.html" target="_blank">やる夫で学ぶフェルマーの最終定理　その１</a> / <a href="http://yaruomatome.blog10.fc2.com/blog-entry-965.html" target="_blank">その２</a> / <a href="http://yaruomatome.blog10.fc2.com/blog-entry-977.html" target="_blank">その３</a> / <a href="http://yaruomatome.blog10.fc2.com/blog-entry-978.html" target="_blank">その４</a> / <a href="http://yaruomatome.blog10.fc2.com/blog-entry-979.html" target="_blank">その５</a> (<a href="http://yaruomatome.blog10.fc2.com/" target="_blank">やる夫ブログ</a>)<br>
<br>
数学の歴史好きとしてはヨダレ物でしたｗｗ　果たして私は死ぬまでにフェルマーの最終定理の証明を理解出来るじゃろうか… (´ω`)<br>
</div>
<h3 class="diary_comment_header">comments</h3>
<div class="diary_comment">
<h3 class="diary_comment_author"> (2009-03-20T10:09:29)</h3>
<div class="diary_comment_body">
数学関係としては「やる夫で学ぶイプシロンデルタ論法」が有名なように思いますが、管理者様にとっては初歩的過ぎますかね。<br>
</div>
<h3 class="diary_comment_author">か (2009-03-21T10:52:47)</h3>
<div class="diary_comment_body">
やる夫で学ぶイプシロンデルタ論法とな！<br>
<br>
全然初歩的じゃありませんよｗ　極限を理解するための大学数学の醍醐味ではありませんか (^ω^)<br>
<br>
今から読んで紹介させてもらいますｗ<br>
</div>
</div>
</div>
<a name="24"></a>
<div class="diary">
<h2 class="diary_date_header">2009-03-24T17:06:29 (Tue)</h2>
<h2 class="diary_title">やる夫で学ぶイプシロンデルタ論法</h2>
<div class="diary_body">
<a href="http://yaruomatome.blog10.fc2.com/blog-entry-404.html" target="_blank">やる夫で学ぶイプシロンデルタ論法</a> (<a href="http://yaruomatome.blog10.fc2.com/" target="_blank">やる夫ブログ</a>)<br>
<br>
先日やる夫で学ぶシリーズを紹介したエントリについたコメントで教わったものです．<br>
<br>
限定後出しジャンケン，実にうまい例えですね．<br>
<br>
要するに「限りなく～～」というのは「～～に限りがある？ううん，ないよ．」という問答と同じなのですね．結局 ε-δ 論法ってのは，その問い (限度) にあたる部分が ε で，否定にあたる部分が δ というただそれだけのことと言えばそれだけのことなのですが…　まぁそりゃそんなの言われて理解出来れば苦労はしません orz<br>
</div>
</div>
<a name="25"></a>
<div class="diary">
<h2 class="diary_date_header">2009-03-25T08:47:39 (Wed)</h2>
<h2 class="diary_title">Dimensions</h2>
<div class="diary_body">
<a href="http://d.hatena.ne.jp/Koumei_S/20090322/1237727846" target="_blank">数学ビデオ「Dimensions」をニコニコ動画にアップしました</a> (<a href="http://d.hatena.ne.jp/Koumei_S/" target="_blank">MediaLab Love</a>)<br>
<br>
4 次元をどう知覚すればいいのかを地図を描くことを引き合いに出した解説から始まり，複素数の利用，ファイブレーション，証明へと続く動画集．<br>
<br>
ファイブレーションの項はサッパリ理解不能でしたが，おおむね面白かったです．<br>
</div>
</div>
<a name="29"></a>
<div class="diary">
<h2 class="diary_date_header">2009-03-29T20:37:29 (Sun)</h2>
<h2 class="diary_title">先日の買い物メモ</h2>
<div class="diary_body">
カッターを買ったー (死<br>
<br>
<a href="http://www.olfa.co.jp/ja/body/detail/101.html" target="_blank">OLFA 166BY (オートロック A 型)</a> という品．いずれ替刃を買うときに型番をメモっておかないと困るので．<br>
<br>
というか，実際に既に持ってたカッターの切れ味が悪くなってきたので替刃を買おうと思ったら型番分からなくて ＼(^o^)／ となったので…<br>
</div>
</div>
<a name="31"></a>
<div class="diary">
<h2 class="diary_date_header">2009-03-31T01:09:42 (Tue)</h2>
<h2 class="diary_title">Squirrel 動作実験 2</h2>
<div class="diary_body">
sqstd_dofile だと動くのに sq_compile だと動かない…<br>
<br>
それが顕著に分かる例を一応メモ．<br>
<br>
<blockquote>#include "stdafx.h"<br>
<br>
#include &lt;iostream&gt;<br>
#include &lt;cstdio&gt;<br>
#include &lt;cstdarg&gt;<br>
using namespace std;<br>
<br>
#undef _UNICODE<br>
<br>
#include &lt;squirrel.h&gt;<br>
#include &lt;sqstdio.h&gt;<br>
<br>
namespace forSquirrel {<br>
<br>
void print(HSQUIRRELVM v, const SQChar* s, ...)<br>
{<br>
　va_list arglist;<br>
　va_start(arglist, s);<br>
　vprintf(s, arglist);<br>
　va_end(arglist);<br>
}<br>
<br>
SQInteger getChar(SQUserPointer fp)<br>
{<br>
　int c = getc(static_cast&lt;FILE*&gt;(fp));<br>
　if (c == EOF) {<br>
　　c = 0;<br>
　}<br>
　return static_cast&lt;SQInteger&gt;(c);<br>
}<br>
<br>
} //end of namespace forSquirrel<br>
<br>
void call_func1(HSQUIRRELVM v, int n, float f, const SQChar* s)<br>
{<br>
　int top = ::sq_gettop(v);<br>
　::sq_pushroottable(v);<br>
　::sq_pushstring(v, _SC("func1"), -1);<br>
　if (SQ_SUCCEEDED(::sq_get(v, -2))) {<br>
　　::sq_pushroottable(v);<br>
　　::sq_pushinteger(v, n); <br>
　　::sq_pushfloat(v, f);<br>
　　::sq_pushstring(v, s, -1);<br>
　　::sq_call(v, 4, SQFalse, true);<br>
　}<br>
　::sq_settop(v, top);<br>
}<br>
<br>
int call_func2(HSQUIRRELVM v, int x, int y)<br>
{<br>
　int top = ::sq_gettop(v);<br>
　::sq_pushroottable(v);<br>
　::sq_pushstring(v, _SC("func2"), -1);<br>
　int ret = 0;<br>
　if (SQ_SUCCEEDED(::sq_get(v, -2))) {<br>
　　::sq_pushroottable(v);<br>
　　::sq_pushinteger(v, x);<br>
　　::sq_pushinteger(v, y);<br>
　　::sq_call(v, 3, SQTrue, true);<br>
　　::sq_getinteger(v, -1, &ret);<br>
　}<br>
　::sq_settop(v, top);<br>
　return ret;<br>
}<br>
<br>
int main()<br>
{<br>
　//初期化<br>
　HSQUIRRELVM v = ::sq_open(1024);<br>
　::sq_seterrorhandler(v);<br>
　::sq_setprintfunc(v, forSquirrel::print);<br>
　::sq_pushroottable(v);<br>
<br>
　//コンパイル相当の作業<br>
　const char* filename = "../test.nut";//"C:\\home\\vc\\project\\sq_test1\\test.nut";<br>
　/*<br>
　//pattern 1<br>
　if (SQ_FAILED(::sqstd_dofile(v, filename, 0, true))) {<br>
　　cout &lt;&lt; "error" &lt;&lt; endl;<br>
　　getchar();<br>
　　return 1;<br>
　}<br>
　*/<br>
　//pattern 2<br>
　/*<br>
　FILE* fp;<br>
　fopen_s(&fp, filename, "r");<br>
　if (fp == NULL) {<br>
　　cout &lt;&lt; "error 1" &lt;&lt; endl;<br>
　　getchar();<br>
　　return 1;<br>
　}<br>
　if (SQ_FAILED(::sq_compile(v, forSquirrel::getChar, fp, filename, SQFalse))) {<br>
　　fclose(fp);<br>
　　cout &lt;&lt; "error 2" &lt;&lt; endl;<br>
　　getchar();<br>
　　return 2;<br>
　}<br>
　fclose(fp);<br>
　*/<br>
<br>
　//実行<br>
　call_func1(v, 1, 2.5, _SC("teststring"));<br>
　cout &lt;&lt; call_func2(v, 10, 20) &lt;&lt; endl;<br>
<br>
　//終了処理<br>
　::sq_pop(v, 1);<br>
　::sq_close(v);<br>
<br>
　//プログラムが一時停止するように書いておく<br>
　cout &lt;&lt; "-- end --" &lt;&lt; endl;<br>
　getchar();<br>
　return 0;<br>
}</blockquote><br>
<blockquote>print("Welcome to Squirrel World!\n");<br>
<br>
function func1(i, f, s) {<br>
　print("Call foo(), i = " + i + ", f = " + f + ", s = '" + s + "'\n");<br>
}<br>
<br>
function func2(x, y) {<br>
　return (x + y);<br>
}<br>
</blockquote><br>
pattern 1 と 2 の部分のコメントアウトを片方だけ外して違いをチェック出来ます．<br>
<br>
目標は Welcom to Squirrel World! の文字列を出さないこと (コンパイルのみに留めること) です．<br>
<br>
[追記]<br>
<br>
解決しました．詳細は次のエントリで．<br>
</div>
</div>
<a name="31"></a>
<div class="diary">
<h2 class="diary_date_header">2009-03-31T23:16:22 (Tue)</h2>
<h2 class="diary_title">Squirrel 動作実験 3</h2>
<div class="diary_body">
今日は色々と分かりました．<br>
<br>
まず，今まで Squirrel のソースで<br>
<br>
<blockquote>function func(x) {<br>
　return x * 2;<br>
}</blockquote><br>
などと書いていましたが，実はこれは<strong>シンタクスシュガー</strong>です．(参考 : <a href="http://wikiwiki.jp/lua/?Squirrel_Lang%2Fch2#w684e090" target="_blank">Squirrel_Lang/ch2 - Lua/組み込み系言語 Wiki (関数宣言)</a>)<br>
<br>
正確には<br>
<br>
<blockquote>this.func <- function(x) {<br>
　return x * 2;<br>
}</blockquote><br>
と書かれるべきのようです．ここでの this が，いわゆるルートテーブルです．<br>
<br>
そこに func というスロットを新規作成して，オブジェクトとして関数を代入すると．<br>
<br>
Lua や Squirrel は関数が第一級のオブジェクトである言語なので，関数ポインタでも何でもない普通の変数に代入するというこの操作が可能です．それ自体は特に不自然でも何でもないですが，これを忘れて先ほどのシンタクスシュガーを C/C++ あるいは Java の脳のままで読んでいると困るのですね．<br>
<br>
つまり，見れば分かる通り，一度はソースファイルを一通り実行しなければ func という名前やスロットもなければ，そこに関数の内容もありはしません (代入されてないので)．<br>
<br>
これが sqstd_dofile だと動くのに sq_compile では動かない理由でした．コンパイルしただけではどうにもならないのですね．<br>
<br>
助言を与えて下さった<a href="http://aoneko.jp/" target="_blank">青猫さん</a>には感謝してもし切れません．一番の助けになったのは恐らく<a href="http://twitter.com/AonekoSS/statuses/1418634818" target="_blank">この POST</a> です．<br>
<br>
(他にも分かったことは色々あります．またまとめなければ…)<br>
</div>
</div>
<a name="31"></a>
<div class="diary">
<h2 class="diary_date_header">2009-03-31T23:43:18 (Tue)</h2>
<h2 class="diary_title">Squirrel 動作実験 補講 0</h2>
<div class="diary_body">
以前自分が書いたソースで<br>
<br>
<pre>_SC(filename)</pre><br>
としてあった箇所があったのですが，このマクロは UNICODE に対応している場合先頭に L を付けるだけなので，このまま UNICODE 対応したのでは当然コンパイルエラー (※Lfilename なんてシンボルはねーよバカ，という内容の) が出ます (^^;<br>
<br>
squirrel.h での実装は以下の通り．<br>
<br>
<blockquote>#ifdef _UNICODE<br>
#define _SC(a) L##a<br>
#else<br>
#define _SC(a) a<br>
#endif<br>
</blockquote><br>
よって修正して来ました orz　文字列リテラルだけを _SC マクロで囲みましょう．<br>
<br>
(※実は正確には上の書き方は違う．SQUNICODE というマクロで条件分岐をしているのだが，SQUNICODE というマクロを定義するかどうかの判定に _UNICODE を使用しているので，上の書き方でも等価である．詳しくは squirrel.h 87 行目以降を参照のこと．)<br>
<br>
ちなみに Visual Studio 2008 で UNICODE 対応を行うかどうかの設定は，<br>
<br>
<strong>プロジェクト > (プロジェクト名) のプロパティ > ※ここでプロパティのダイアログが開かれる (Alt + F7 のショートカットでも OK) > 構成プロパティ > 全般 > プロジェクトの規定値 > 文字セット</strong><br>
<br>
ここの値を「設定なし」にすると UNICODE 対応なし (_UNICODE マクロが定義されない状態) に，「Unicode 文字セットを使用する」にすると UNICODE 対応あり (_UNICODE マクロが定義される状態) になります．<br>
</div>
</div>
<hr>
<a href="./">戻る</a>
<hr>
</body>
</html>
