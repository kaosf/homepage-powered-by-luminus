<!DOCTYPE html>
<html lang="ja">
<head>
<meta http-equiv="content-type" content="text/html" charset="utf-8">
<link rel="stylesheet" href="diary.css" type="text/css">
<title>2007-03</title>
</head>
<body>
<h1 class="diary_month">2007-03</h1>
<hr>
<a href="./" class="diary">戻る</a>
<hr>
<a name="05"></a>
<div class="diary">
<h2 class="diary_date_header">2007-03-05T00:00:00 (Mon)</h2>
<h2 class="diary_title">毎週金曜日は金糸雀の日！バーロー今日は月曜日だよ！</h2>
<div class="diary_body">
<p class="diary">
ごきげんよう．“か”です．ここんとこ花粉でマジ参ってます．精神状態があまりよろしくないです orz　日記更新してなくてごめんなさい（まぁ見てる人あんまり居ないと思うけどねー！）．
</p>
<p class="diary">
そんなわけで，製作は順調に停滞中です．いつものことですが（ぉ
</p>
<p class="diary">
とりあえずプロフィールのところにメールアドレスを晒してみたんですがやはり何も届く気配がありません．そりゃそうだろ．
</p>
<p class="diary">
閲覧者からの反応が日記を書く原動力になるということは多々あるので，おなじみ web 拍手を設置したいと思います．ていうか設置しました．ポチッと押してくれると嬉しいです．メッセージも添えて送ってくれると悶絶します．
</p></div>
</div>
<a name="06"></a>
<div class="diary">
<h2 class="diary_date_header">2007-03-06T00:00:00 (Tue)</h2>
<h2 class="diary_title">金糸雀ランド製作進捗状況</h2>
<div class="diary_body">
<p class="diary">
しりとり・神経衰弱のときに使うパネルを管理する仕組みを作りました．しかし，画像がない + しりとり・神経衰弱でバトルする仕組みが未完成という状況なので，正しく作れたのかどうか確認する術がありません．いと恐ろしや，幾日か後のビルド作業．
</p>
<p class="diary">
あとステージのアクションに関する部分で，環境に依存するバグを発見 orz<br />
マップチップとの当たり判定がかなーり複雑なことをしてるせいか，ohrin PC では再現せず，マイ PC では確実に再現するというバグです．具体的に何が起こるのかは面倒なので書きませんが，要するに環境依存のバグです．プログラム経験のある方ならコイツの性質の悪さはお分かりいただけるかと．<br />
自分のマシンでは確実に再現するのでアルゴリズムのミスだとばかり思っていたのですが，先日 ohrin の PC で動かしてみてあらビックリ(・・； というわけです．
</p>
<p class="diary">
あっちもこっちも難航してます．私はソース修正に奔走してます．そして絵を描く気が起こらなくて絶望してます．
</p></div>
</div>
<a name="06"></a>
<div class="diary">
<h2 class="diary_date_header">2007-03-06T00:00:01 (Tue)</h2>
<h2 class="diary_title">拍手レス（05日）</h2>
<div class="diary_body">
<p class="diary">
<font class="clap">
23時<br />
&gt;ぃょぅ！華麗に俺様参上！！！がんがれよ〜by○○くん（リアルネームのため伏せ）<br />
</font>
ありがとうありがとう！君が拍手送信者第一号だよ！がんがるよ〜．
</p></div>
</div>
<a name="09"></a>
<div class="diary">
<h2 class="diary_date_header">2007-03-09T00:00:00 (Fri)</h2>
<h2 class="diary_title">結構ダラダラしてました</h2>
<div class="diary_body">
<p class="diary">
この数日間は結構のんびりとしていました．とりあえず，オーベルテューレのDVDを買った辺りでおかしくなった気がします．ベッドの脇にノートPCを置いて寝そべりながらアレコレ出来るという環境をマイルームに構築してしまった辺り何か変でした．今朝撤去しましたがね．
</p>
<p class="diary">
てことで進捗状況は芳しくないです orz　やっぱり素材が欲しいなぁ…　自分で用意するしかないというのが面倒くさすぎる．しかしそれは今回自分で望んだことなので諦めます．
</p></div>
</div>
<a name="09"></a>
<div class="diary">
<h2 class="diary_date_header">2007-03-09T00:00:01 (Fri)</h2>
<h2 class="diary_title">ゲームパッド</h2>
<div class="diary_body">
<p class="diary">
最近オープンしたばかりの家電量販店に昨日視察がてら行ってきたわけなんですが，そこでゲームパッドを一つ購入しました．<a href="http://www2.elecom.co.jp/peripheral/gamepad/jc-u1608t/index.asp" target="_blank" class="diary">ELECOM の SFC 風コントローラ</a>です．以前他の店で見かけたときに，なんとなく欲しいなぁ，でも地雷臭が漂ってるなぁ，なんて考えていたモノだったんですが，所詮1280円だったので地雷でもいいやと思って購入しました．
</p>
<p class="diary">
結果，やはり地雷でした orz　ボタンの連打に追従しません．5連打につき1回分くらい，信号が送られません．チョン避けが重要な昨今の STG において致命的です．
</p>
<p class="diary">
どうして ELECOM ってこう中途半端なのかねぇ(^^;　何年か前に買ったこれとは違うパッドも，こんな感じで不具合がありました．シェアは広いだろうから，あとは高クオリティさえ実現してしまえば周辺機器業界の TOP に易々と立てそうな気がするんですが．それとも SONY 純正の PS コントローラがクオリティ高すぎるだけ？
</p></div>
</div>
<a name="10"></a>
<div class="diary">
<h2 class="diary_date_header">2007-03-10T00:00:00 (Sat)</h2>
<h2 class="diary_title">製作の進行状況</h2>
<div class="diary_body">
<p class="diary">
いつまで経ってもスクリーンショットをアップできなくて申し訳ないです．<br />
まだまだ見せるわけにはいかないような出来ですのでどうかその辺りご勘弁を orz
</p>
<p class="diary">
とりあえず数字探しだけでも対戦出来るようにしてみようかと思ってプログラムやってたら，これが思った以上にハードでした．あんなゲーム一つとってもそこそこのコーディング量とフローチャートが必要でした．やっぱり見積もりが甘かったなぁと痛感しています．
</p>
<p class="diary">
ちなみに現在ソースファイルは .cpp .h あわせて60ほど．行数の総数は約4600（空行も含む）でした．間違いなく今までの人生で最大規模です．そしてこれの2倍以上には間違いなく増えます．ですがフォルダ分けが思った以上にきちんと出来てたのでまだ結構管理しやすいです．各ソースファイルの行数も200行を超えない程度です．たまに超えているのがあるのは，開発初期に作っていたブツ(^^;　あ，ソースの行数を抑えるのは Visual Studio を使ってない人にとっては超重要問題なんですよｗ　ブロックを閉じたり開いたり出来る機能がついたあのエディタはまったくもって羨ましい限りですｗ
</p>
<p class="diary">
明日中には数字探しの対戦がゲームとして出来るようにしてやろうと思っているわけですが，はてさて…
</p></div>
</div>
<a name="10"></a>
<div class="diary">
<h2 class="diary_date_header">2007-03-10T00:00:01 (Sat)</h2>
<h2 class="diary_title">新携帯買いました</h2>
<div class="diary_body">
<p class="diary">
<img src="img/20070310a.jpg" class="diary"> <img src="img/20070310b.jpg" class="diary"><br />
ドコモの FOMA D903i です．カラーはオータムゴールド．<br />
どうしてこの色にしたのかって，それはもちろん金糸雀んゴールドだからです．メニュー画面のカラーデザインなんかも黄色を基調としたものに変更しまくりました．あとは頑張ってピチカート日和とかを取り込めば完璧ですね Σd(・ω・)
</p></div>
</div>
<a name="11"></a>
<div class="diary">
<h2 class="diary_date_header">2007-03-11T00:00:00 (Sun)</h2>
<h2 class="diary_title">プログラムメモ その1</h2>
<div class="diary_body">
<p class="diary">
GoF デザインパターンの一つに，シングルトンパターンというのがあります．これは理解も習得も比較的容易なので使っている人も多いのではないでしょうか．かく言う自分も，これを覚えてからゲームプログラムのあちこちにこのパターンを使っています．
</p>
<p class="diary">
とりあえず習得に関しては<a href="http://www.geocities.jp/bleis_tift/cpp/singleton.html" target="_blank" class="diary">このページ</a>でも読めば分かるでしょう．しかし，このサンプルにはまだ欠陥が残っています．
</p>
<p class="diary">
その欠陥について記載された web ページを忘れてしまったことが残念でならないのですが，答えは「コピーコンストラクタが public なままであること」です．
</p>
<p class="diary">
つまり，
</p>
<p class="diary">
SingletonClass &sc = SingletonClass::getInstance();<br />
SingletonClass sc2(sc); //コピーコンストラクタが呼べる．ここで2つ目のインスタンス sc2 が生成されてしまう．
</p>
<p class="diary">
これでコンパイルが通ってしまい，インスタンスが2つ生成されるのです．
</p>
<p class="diary">
これを解決するためには，Class の定義部分に
</p>
<p class="diary">
private:<br />
　SingletonClass();<br />
　SingletonClass(const SingletonClass &obj); //この1行を追加する
</p>
<p class="diary">
としてやればOKです．デフォルトのコピーコンストラクタもきちんと private にしてしまう，と．<br />
しかしこれは見落とすわ…　またこの記述があったページを思い出せたら（再び辿り着けたら）紹介します．
</p></div>
</div>
<a name="11"></a>
<div class="diary">
<h2 class="diary_date_header">2007-03-11T00:00:01 (Sun)</h2>
<h2 class="diary_title">プログラムメモ その2</h2>
<div class="diary_body">
<p class="diary">
シングルトンパターンで作ったクラスは，コンストラクタが main 関数以前に呼ばれるために，コンストラクタ内に複雑なコードを書きたくありません．よって自前の初期化・終了処理用メンバ関数を用意します．Start() End() とか，Create() Destroy() とか．自分は Init() End() としています．
</p>
<p class="diary">
ここで単純な多重 delete 防止機能を作りましょう．<br />
まず，メンバ変数に bool InitWasCalled という変数を定義．コンストラクタでこれを false に設定します．<br />
そして，Init() End() をそれぞれ
</p>
<p class="diary">
void SingletonClass::Init()<br />
{<br />
　if (!InitWasCalled) {<br />
　　//初期化処理<br />
　　InitWasCalled = true;<br />
　}<br />
}<br />
void SingletonClass::End()<br />
{<br />
　if (InitWasCalled) {<br />
　　//終了処理<br />
　　InitWasCalled = false;<br />
　}<br />
}<br />
とします．これで，何度 Init() End() を呼んでも安心です．必ず1回の初期化に1回の終了が対応します．いやまぁ，それだけ(^^;　あんまり大したことじゃないけどｗ
</p></div>
</div>
<a name="11"></a>
<div class="diary">
<h2 class="diary_date_header">2007-03-11T00:00:02 (Sun)</h2>
<h2 class="diary_title">気になること</h2>
<div class="diary_body">
<p class="diary">
Init (Initialize) の反対は本当に End でいいんだろうか？ちょっと気になるので誰か教えてちょうだい（他力本願
</p></div>
</div>
<a name="14"></a>
<div class="diary">
<h2 class="diary_date_header">2007-03-14T00:00:00 (Wed)</h2>
<h2 class="diary_title">そろそろ三月の半分が過ぎるな…</h2>
<div class="diary_body">
<p class="diary">
思えばこれまたろくに作業が進んでない月だ orz　このまま気付けば春休みが終わってるんだろうな．<br />
これが私の本性です．え？知ってるって？<br />
でも今週はそれに加えて，色々と行事があった（まだ予定もある）もんで，更に進まなさそうです．あとネタに詰まってるってのもあるし…
</p>
<p class="diary">
システムの開発にこれじゃあ，ステージの作成が思いやられるのぅ．予定では3つの難易度でそれぞれ20ステージ以上，最難レベルで更にプラス5ステージくらいという，実に無謀というか，「それは計画じゃない，妄想だ (・ω・)」と言われても何も言い返せないそんなプランが練られています．5割の確率で無理なのは最初から承知の上です．まぁ，4月のスパート次第だな…
</p></div>
</div>
<a name="14"></a>
<div class="diary">
<h2 class="diary_date_header">2007-03-14T00:00:01 (Wed)</h2>
<h2 class="diary_title">拍手レス(14日)</h2>
<div class="diary_body">
<p class="diary">
<font class="clap">
7時<br />
&gt;うっかり汽車に乗れず2時間待ちの刑です。本当に(ry<br />
</font>
送信者が名乗ってませんが，多分 TAKKON でしょう．まぁ安く帰れるんだからいいでないの (ノ∀｀)<br />
本州に入りさえすれば後は楽ですよ．
</p></div>
</div>
<a name="18"></a>
<div class="diary">
<h2 class="diary_date_header">2007-03-18T00:00:00 (Sun)</h2>
<h2 class="diary_title">いい加減にしたい</h2>
<div class="diary_body">
<p class="diary">
毎フレーム，パッド or キーボードの入力を取得して，カーソルを動かしたり決定・キャンセル処理を行ったりする…<br />
この方針に間違いはないはず．で，それを単純に
</p>
<p class="diary">
if (左方向の入力があった) {<br />
　カーソルを左に動かす;<br />
}
</p>
<p class="diary">
と，毎フレームの処理のところに書くと悲惨なことが起こりますね．60FPSのゲームだと間違いなくカーソルは3マス以上動きます．<br />
てことで，静的な変数 int PushedTimer を用意して，
</p>
<p class="diary">
//初期化部分<br />
PushedTimer = 0;
</p>
<p class="diary">
//カーソル移動処理部分<br />
if (PushedTimer == 0) {<br />
　if (左方向の入力があった) {<br />
　　カーソルを左に動かす;<br />
　　PushedTimer = 8; //適当な連射抑制の時間を代入<br />
　}<br />
}<br />
else {<br />
　PushedTimer--;<br />
}
</p>
<p class="diary">
しかしこれではダメな場合というのもあります．押しっぱなしによる連続動作を無効にしたい場合です．<br />
この場合は bool Pushed という静的な変数を用意して，
</p>
<p class="diary">
//初期化部分<br />
Pushed = false;
</p>
<p class="diary">
//カーソル移動処理部分<br />
if (!Pushed) {<br />
　if (左方向の入力があった) {<br />
　　カーソルを左に動かす;<br />
　　Pushed = true;<br />
　}<br />
}<br />
else {<br />
　if (左方向の入力がなかった) Pushed = false;<br />
}
</p>
<p class="diary">
これでカーソルは一回のプレスによって一回動きます．
</p>
<p class="diary">
この二つを組み合わせたいとき，つまり連打すれば押した回数分だけカーソルは動かせるが，押しっぱなしでもカーソルを動かし続けたいとき．<br />
最初の例に
</p>
<p class="diary">
//初期化部分<br />
PushedTimer = 0;
</p>
<p class="diary">
//カーソル移動処理部分<br />
if (PushedTimer == 0) {<br />
　if (左方向の入力があった) {<br />
　　カーソルを左に動かす;<br />
　　PushedTimer = 8; //適当な連射抑制の時間を代入<br />
　}<br />
}<br />
else {<br />
　//以下の様に変更<br />
　<strong>if (左方向の入力がなかった) PushedTimer = 0;<br />
　else PushedTimer--;</strong><br />
}
</p>
<p class="diary">
で，これを見れば分かることなんですけど，「結構行数が多い」んですよね．
</p>
<p class="diary">
こんなのを至るところで書きます．カーソルの移動なら，これが上下左右それぞれにあって，そして優先順位があります．その場合は以下のように書き換えます．
</p>
<p class="diary">
//初期化部分<br />
PushedTimerL = 0;<br />
PushedTimerR = 0; //L, R の二つを用意する
</p>
<p class="diary">
//カーソル移動処理部分<br />
if (左方向の入力があった && 右方向の入力がなかった) {<br />
　if (PushedTimerL == 0) {<br />
　　カーソルを左に動かす;<br />
　　PushedTimerL = 8;<br />
　}<br />
　else {<br />
　　PushedTimerL--;<br />
　}<br />
}<br />
else if (左方向の入力がなかった) {<br />
　PushedTimerL = 0;<br />
}<br />
if (右方向の入力があった) {<br />
　if (PushedTimerR == 0) {<br />
　　カーソルを右に動かす;<br />
　　PushedTimerR = 8;<br />
　}<br />
　else {<br />
　　PushedTimerR--;<br />
　}<br />
}<br />
else {<br />
　PushedTimerR = 0;<br />
}
</p>
<p class="diary">
これで右方向の入力が優先されます．
</p>
<p class="diary">
…なんていうか，めちゃくちゃ<strong>面倒臭い</strong>んですよね！そしてどうにも例外的な処理に対する記述ばかりしている気がするんですよね．一般的でないというか，スマートでないというか．
</p>
<p class="diary">
だからどうにもルーチンに分けられない．オブジェクトに分けられない．<br />
そんなわけで，パッド等からの入力が絡む処理の部分は，毎回こんなのを書いているため壮絶なソースコードが生み出されております… (-_-;)　そりゃもう壮絶．動いてるんだけど，こういう頭悪いコードは一番許せないタイプです．
</p>
<p class="diary">
…時が解決してくれるのを信じて待ち，今はひたすらにこれを書いて書いて書き抜くのみ…
</p></div>
</div>
<a name="22"></a>
<div class="diary">
<h2 class="diary_date_header">2007-03-22T00:00:00 (Thu)</h2>
<h2 class="diary_title">ご無沙汰です</h2>
<div class="diary_body">
<p class="diary">
“か”です．三月中にゲーム紹介のページを作るとか言っておいてまだ公開できるレベルのスクリーンショットが撮れる段階ではありません．後悔できるスクリーンショットなら何枚でも撮れますがね．<br />
…誰が上手いこと言えと…　…あんまり上手くないし orz
</p>
<p class="diary">
数字探しがやっと出来るようになりました．メッセージウィンドウを作りたいです．作りたいです…　作れないです orz　頭が弱いから…<br />
どうやら俺たちは，カナリーややこしい（※ゲームプログラミング初心者にとってのレベル）ゲームを作ろうとしていたみたいだ…
</p></div>
</div>
<a name="22"></a>
<div class="diary">
<h2 class="diary_date_header">2007-03-22T00:00:01 (Thu)</h2>
<h2 class="diary_title">ゲベートガルテン</h2>
<div class="diary_body">
<p class="diary">
<a href="http://www.taito.co.jp/d3/cp/rozenmaiden_gg/" target="_blank" class="diary">ローゼンメイデンゲベートガルテン</a>（※音が出ます）（<a href="http://www.taito.co.jp/" target="_blank" class="diary">タイトー</a>）<br />
買いました (´・ω・｀)<br />
買いました ＼(＾o＾)／<br />
…察して下さい orz
</p>
<p class="diary">
あの製作スタッフたちにはこのゲームを踏み台に頑張って行って欲しいです．
</p></div>
</div>
<a name="25"></a>
<div class="diary">
<h2 class="diary_date_header">2007-03-25T00:00:00 (Sun)</h2>
<h2 class="diary_title">メッセージウィンドウ</h2>
<div class="diary_body">
<p class="diary">
久しぶりにプログラムで徹夜しました．あぁ，お腹空いた…<br />
んで，きっとメッセージウィンドウが出来ました．結構長いこと（ほんと何日も）思い悩んでたんで，結果としては複雑なコードが出来るんだろうなと思ったら意外にコンパクトに収まりました（クラス2個）．やっぱりコンテナは使うもんだね．あと do while ループなんてのを久しぶりに使ったりも．<br />
このあとすぐにテストしたいです．どうせ不備が見つかって，正常に動かせるようになるまでにのに今日一日費やすだろうから orz
</p>
<p class="diary">
ところで，現在製作自体は1ヶ月遅れてるんですよねｗ　はい，どう見ても計画が甘かった．自分の性格を把握しきれてなかった．どこの馬鹿だよ，2月中にプログラム打ち切りとか言ってた奴は．ドッキドキワックワクの修羅場は恐らく4月の中ごろから．乞うご期待！
</p></div>
</div>
<a name="30"></a>
<div class="diary">
<h2 class="diary_date_header">2007-03-30T00:00:00 (Fri)</h2>
<h2 class="diary_title">ボスバトルが徐々に完成中</h2>
<div class="diary_body">
<p class="diary">
相変わらずグラフィックがショボイ…というか間に合わせのモノばかりですが，メッセージウィンドウの完成に影響されてボスバトルがじわじわと出来上がっております．春休み中にこいつらを完成させます．んで学校が始まったらステージとグラフィックの同時進行というプランで進めます．今はただ，全国の金糸雀ファンに申し訳のないような作品にはしたくないという気持ちで製作しています．
</p>
<p class="diary">
しかしゲームの華とも言えるグラフィックがどれ一つとしてまともに完成していない現状はどうにかしなきゃなぁ…　それさえ出来てればスクリーンショットの公開にも踏み切れるんだけど…
</p></div>
</div>
<a name="30"></a>
<div class="diary">
<h2 class="diary_date_header">2007-03-30T00:00:01 (Fri)</h2>
<h2 class="diary_title">第二回漫画最萌トーナメント</h2>
<div class="diary_body">
<p class="diary">
<a href="http://max.45.kg/mangasaimoe/" target="_blank" class="diary">まとめサイト</a><br />
ちょっと話題が遅れましたが，第二回漫画最萌トーナメントで金糸雀が優勝しました．金糸雀の可愛さが広く認められたというよりは，ローゼンメイデンというタイトルの大きさを改めて思い知った，という感じですね．翠星会・水銀党の票が完全に無ければ準決勝すら危うかったのでは？と思います．というか準々決勝で翠星石に勝ったのが一番の謎ですｗ
</p>
<p class="diary">
まぁ何はともあれ，ローゼン一の不人気・いらない子と言われ続け，辛酸を舐め続けてきた我らが金糸雀，そしてピチカー党がついに勝ったのです．金糸雀スキーとしては嬉しい限りです．<br />
おめでとう！カナ！
</p></div>
</div>
<hr>
<a href="./">戻る</a>
<hr>
</body>
</html>
